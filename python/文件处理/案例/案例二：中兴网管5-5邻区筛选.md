# 中兴网管5-5邻区筛选

```python
import pandas as pd


file_path = "D:/桌面/RANCM-新开站-5-5邻区-ZZ_zhangjie-20220706091029_ITRAN-PNF_V5.45.20.20.xlsx"

data1 = pd.read_excel(file_path,sheet_name ="ExternalNRCellCU")
data2 = pd.read_excel(file_path,sheet_name ="SsbMeasInfo")
data3 = pd.read_excel(file_path,sheet_name ="NRCellRelation")
data4 = pd.read_excel(file_path,sheet_name ="TemplateInfo")
data5 = pd.read_excel(file_path,sheet_name ="Index")

# 删除小区明细
list = ["4857155-1152","4857155-1153","4857155-1154","4857155-1155","4857155-1156",
        "4857155-1157","4857155-1158","4857155-1159","4857155-1160","4857155-1161",
        "4857155-1162","4857155-1163","4857155-1164","4857155-1165","4857155-1166",
        "4857155-1168","4857156-1152","4857156-1154","4857156-1156","4857156-1158",
        "4857156-1161","4857156-1162","4857156-1163","4857156-1164","4857156-1165",
        "4857156-1166","4857156-1167","4857156-1168","4857157-1152","4857157-1153",
        "4857157-1154","4857157-1155","4857157-1156","4857157-1157","4857157-1158",
        "4857157-1159","4857157-1160","4857157-1161","4857157-1162","4857157-1164",
        "4857157-1166","4857157-1168","4857158-1152","4857158-1153","4857158-1154",
        "4857158-1155","4857158-1156","4857158-1157","4857158-1158","4857158-1159",
        "4857158-1160","4857158-1162","4857158-1163"]

# data1 【ExternalNRCellCU】数据处理
data1_t = data1.iloc[0:4]
data1["moId01"]=data1["moId"].str.replace("460-11-","").str.replace("460-01-","").str.replace("Anr-","")
data1_1=data1[data1["moId01"].isin(list)].drop(["moId01"],axis = 1)
data1_2 = pd.concat([data1_t ,data1_1] , ignore_index = True)

# data2 【SsbMeasInfo】数据处理
data2_t =data2.iloc[0:4]
data2["ldn01"] = data2["ldn"].str.extract(".*NRCellCU=(.*?),SsbMeasInfo")
data2["ldn01"] = data2["ldn01"].str.replace("460-11-","").str.replace("460-01-","").str.replace("Anr-","")
data2_1=data2[data2["ldn01"].isin(list)].drop(["ldn01"],axis = 1)
data2_2 = pd.concat([data2_t ,data2_1] , ignore_index = True)


# data3 【NRCellRelation】数据处理
data3_t =data3.iloc[0:4]
data3["moId01"]=data3["moId"].str.replace("460-11-","").str.replace("460-01-","").str.replace("Anr-","")
data3_1=data3[data3["moId01"].isin(list)].drop(["moId01"],axis = 1)
data3_2 = pd.concat([data3_t ,data3_1] , ignore_index = True)


file_path = "D:/桌面/RANCM-新开站-5-5邻区-删除脚本.xlsx"
writer = pd.ExcelWriter(file_path,engine="xlsxwriter")


data5.to_excel(writer,sheet_name = "Index",index = False)
data4.to_excel(writer,sheet_name = "TemplateInfo",index = False)

data1_2.to_excel(writer,sheet_name = "ExternalNRCellCU",index = False)
data2_2.to_excel(writer,sheet_name = "SsbMeasInfo",index = False)
data3_2.to_excel(writer,sheet_name = "NRCellRelation",index = False)
writer.save()
```

