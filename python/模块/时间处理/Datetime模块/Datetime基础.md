# Datetime 基础

# 一、获取当前时刻的时间

## 1.1、返回当前时刻的日期和时间

```
from datetime import datetime
datetime.now()

# 2022年6月25日18时27分51秒
datetime.datetime(2022, 6, 25, 18, 27, 51, 806247) 
```

## 1.2、分别返回当前时刻的年、月、日

利用 year 、month、day 属性，举例：`datetime.now().year`

## 1.3、返回当前时刻周数

### 1.3.1 返回周几

利用 weekday() 方法，python中周几是从 0 开始数的，要在后面加1，举例：`datetime.now().weekday() + 1`

### 1.3.2 返回周数

利用 `isocalendar()` 方法，举例：`datetime.now().isocalendar()[1]`

```
datetime.now().isocalendar()

# 2022年第25周第6天
(2022, 25, 6)
```

# 二、指定日期和时间格式

## 2.1、 仅显示日期

利用 date() 方法，举例：`datetime.now().date()`

## 2.2、 仅显示时间

利用 time() 方法，举例：`datetime.now().time()`

## 2.3、 自定义时间和日期格式

利用 `strftime()` 方法，举例：`datetime.now().strftime("%Y==%m==%d")`

格式：

| 代码 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
| %a   | 星期的简写。如星期三为Web                                    |
| %A   | 星期的全写。如星期三为Wednesday                              |
| %b   | 月份的简写。如4月份为Apr                                     |
| %B   | 月份的全写。如4月份为April                                   |
| %c   | 日期时间的字符串表示。（如04/07/10104339）                   |
| %d   | 日在这个月中的天数（是这个月的第几天）                       |
| %f   | 微秒（范围[0,999999]）                                       |
| %H   | 小时（24小时制，[0,23]）                                     |
| %I   | 小时（12小时制，[0,11]）                                     |
| %j   | 日在年中的天数[001,366]（是当年的第几天）                    |
| %m   | 月份（[01,12]）                                              |
| %M   | 两位数的分（[00,59]）                                        |
| %p   | AM或者PM                                                     |
| %S   | 秒（范围为[00,61]（60和61用于闰秒），为什么不是[00,59]，参考python手册~_~） |
| %U   | 每年的第几周，星期天作为周的第一天                           |
| %w   | 用整数表示星期几，范围为[0,6]，6表示星期天                   |
| %W   | 每年的第几周，星期一作为周的第一天                           |
| %x   | 日期字符串（如04/07/10）                                     |
| %X   | 时间字符串（如104339）                                       |
| %y   | 2个数字表示的年份                                            |
| %Y   | 4个数字表示的年份                                            |
| %z   | 与utc时间的间隔（如果是本地时间，返回空字符串）              |
| %Z   | 时区名称（如果是本地时间，返回空字符串）                     |
| %%   | %%=>%                                                        |
| %F   | %Y-%m-%d的简写，例如：2018-04-18                             |
| %D   | %m/%d/%y的简写，例如：04/18/2018                             |

# 三、字符串和时间格式相互转换

## 3.1、时间格式转换为字符串格式

利用 `str()` 方法，举例：`str(datetime.now())`

利用 `strftime()` 方法，举例：`datetime.now().strftime("%Y-%m-%d")`

## 3.2、字符串格式转换为时间格式

- 利用 `strptime()` 方法，举例：`datetime.strptime("2022-6-25","%Y-%m-%d")`

- 利用 parse() 方法，举例：`parse("2022-6-25")`

```
from dateutil.parser import parse
parse("2022-6-25")

datetime.datetime(2022, 6, 25, 0, 0)
```

# 四、时间筛选

## 4.1、时间索引列

利用 `loc()` 方法，举例：`df1.loc["2022-07"]`

## 4.2 、时间普通列

利用 布尔索引 筛选，举例：`df[df[“日期] == datetime( 2022 , 06 , 11)]`

# 五、时间运算

## 5.1、两个时间差

两个时间差是一个 timedelta 对象，包含天数、秒、微秒三个等级，举例：

```
datetime(2018 , 5,21,19,50) - datetime(2018,5,18,20,32)

datetime.timedelta(days=2, seconds=83880)
```

天时间差：days

秒时间差：seconds，换算小时 除以3600

## 5.2 时间偏移

给时间往前推或往后推一段时间。

- timedelta：支持天、秒、微秒时间偏移，举例：往后推1天 `datetime(2018,5,18,20,32) + timedelta( days = 1)`

- date offset：支持天、小时、分钟时间偏移,是 Pandas 中日期偏移量

  ```
  from pandas.tseries.offsets import Day,Hour,Minute
  date = datetime(2022,6,25,20,27)
  date + Day(1)
  
  Timestamp('2022-06-26 20:27:00')
  ```